INFO - PPO - Running command 'ppo_run'
INFO - PPO - Started run with ID "2"
Creating env with params {'RUN_TYPE': 'ppo', 'SEEDS': [9456, 1887, 5578, 5987, 516], 'LOCAL_TESTING': False, 'EX_NAME': 'ppo_bc_train_random0_test1', 'SAVE_DIR': 'data/ppo_runs/2021_07_21-09_02_08_ppo_bc_train_random0_test1/', 'GPU_ID': 0, 'PPO_RUN_TOT_TIMESTEPS': 9000000.0, 'mdp_params': {'layout_name': 'random0', 'start_order_list': None, 'rew_shaping_params': {'PLACEMENT_IN_POT_REW': 3, 'DISH_PICKUP_REWARD': 3, 'SOUP_PICKUP_REWARD': 5, 'DISH_DISP_DISTANCE_REW': 0, 'POT_DISTANCE_REW': 0, 'SOUP_DISTANCE_REW': 0}}, 'env_params': {'horizon': 400}, 'mdp_generation_params': {'padded_mdp_shape': [11, 7], 'mdp_shape_fn': [[5, 11], [5, 7]], 'prop_empty_fn': [0.6, 1], 'prop_feats_fn': [0, 0.6]}, 'ENTROPY': 0.1, 'GAMMA': 0.99, 'sim_threads': 30, 'TOTAL_BATCH_SIZE': 12000, 'BATCH_SIZE': 400, 'MAX_GRAD_NORM': 0.1, 'LR': 0.0015, 'LR_ANNEALING': 2, 'VF_COEF': 0.1, 'STEPS_PER_UPDATE': 8, 'MINIBATCHES': 15, 'CLIPPING': 0.05, 'LAM': 0.98, 'SELF_PLAY_HORIZON': None, 'REW_SHAPING_HORIZON': 4000000.0, 'OTHER_AGENT_TYPE': 'bc_train', 'HM_PARAMS': [True, 0.3], 'NUM_HIDDEN_LAYERS': 3, 'SIZE_HIDDEN_LAYERS': 64, 'NUM_FILTERS': 25, 'NUM_CONV_LAYERS': 3, 'NETWORK_TYPE': 'conv_and_mlp', 'SAVE_BEST_THRESH': 50, 'TRAJECTORY_SELF_PLAY': True, 'VIZ_FREQUENCY': 50, 'grad_updates_per_agent': 90000.0}
Computing MediumLevelPlanner to be saved in /Users/michellezhao/Documents/overcooked-teaming/overcooked_ai/overcooked_ai_py/data/planners/random0_am.pkl
It took 0.04539823532104492 seconds to create mlp
LOADING BC MODEL FROM: random0_bc_train_seed0
Loading a model without an environment, this model cannot be trained until it has a valid environment.
WARNING:tensorflow:From /opt/anaconda3/envs/hr-team/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING - tensorflow - From /opt/anaconda3/envs/hr-team/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /Users/michellezhao/Documents/overcooked-teaming/stable-baselines/stable_baselines/common/policies.py:436: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
WARNING - tensorflow - From /Users/michellezhao/Documents/overcooked-teaming/stable-baselines/stable_baselines/common/policies.py:436: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
WARNING:tensorflow:From /opt/anaconda3/envs/hr-team/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING - tensorflow - From /opt/anaconda3/envs/hr-team/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /opt/anaconda3/envs/hr-team/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:102: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
WARNING - tensorflow - From /opt/anaconda3/envs/hr-team/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:102: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
Mlp with different params or mdp found, computing from scratch
Computing MediumLevelPlanner to be saved in /Users/michellezhao/Documents/overcooked-teaming/overcooked_ai/overcooked_ai_py/data/planners/random0_am.pkl
It took 0.03785419464111328 seconds to create mlp
WARNING:tensorflow:From /Users/michellezhao/Documents/overcooked-teaming/baselines/baselines/common/input.py:57: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING - tensorflow - From /Users/michellezhao/Documents/overcooked-teaming/baselines/baselines/common/input.py:57: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
(30, 5, 5, 20)
WARNING:tensorflow:From /Users/michellezhao/Documents/overcooked-teaming/human_aware_rl/baselines_utils.py:127: conv2d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.conv2d instead.
WARNING - tensorflow - From /Users/michellezhao/Documents/overcooked-teaming/human_aware_rl/baselines_utils.py:127: conv2d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.conv2d instead.
WARNING:tensorflow:From /Users/michellezhao/Documents/overcooked-teaming/human_aware_rl/baselines_utils.py:143: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING - tensorflow - From /Users/michellezhao/Documents/overcooked-teaming/human_aware_rl/baselines_utils.py:143: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
Last layer conv network output shape (30, 64)
(800, 5, 5, 20)
Last layer conv network output shape (800, 64)
TOT NUM UPDATES 0
TOT NUM UPDATES 750
SP envs: 0/30
Other agent actions took 3.9465110301971436 seconds
Total simulation time for 400 steps: 6.624632120132446 	 Other agent action time: 0 	 60.38071137329854 steps/s
Curr learning rate 0.0015 	 Curr reward per step 0.023333333333333334

0/8:   0%|          | 0/15 [00:00<?, ?it/s]
0/8:   7%|▋         | 1/15 [00:00<00:02,  5.23it/s]
0/8:  13%|█▎        | 2/15 [00:00<00:01,  6.61it/s]
0/8:  20%|██        | 3/15 [00:00<00:01,  7.28it/s]
0/8:  27%|██▋       | 4/15 [00:00<00:01,  7.66it/s]
0/8:  33%|███▎      | 5/15 [00:00<00:01,  7.90it/s]
0/8:  40%|████      | 6/15 [00:00<00:01,  7.98it/s]
0/8:  47%|████▋     | 7/15 [00:00<00:00,  8.07it/s]
0/8:  53%|█████▎    | 8/15 [00:01<00:00,  8.11it/s]
0/8:  60%|██████    | 9/15 [00:01<00:00,  8.11it/s]
0/8:  67%|██████▋   | 10/15 [00:01<00:00,  8.16it/s]
0/8:  73%|███████▎  | 11/15 [00:01<00:00,  8.14it/s]
0/8:  80%|████████  | 12/15 [00:01<00:00,  8.14it/s]
0/8:  87%|████████▋ | 13/15 [00:01<00:00,  8.14it/s]
0/8:  93%|█████████▎| 14/15 [00:01<00:00,  8.00it/s]
0/8: 100%|██████████| 15/15 [00:01<00:00,  8.03it/s]
0/8: 100%|██████████| 15/15 [00:01<00:00,  7.86it/s]

1/8:   0%|          | 0/15 [00:00<?, ?it/s]
1/8:   7%|▋         | 1/15 [00:00<00:01,  8.18it/s]
1/8:  13%|█▎        | 2/15 [00:00<00:01,  8.19it/s]
1/8:  20%|██        | 3/15 [00:00<00:01,  8.18it/s]
1/8:  27%|██▋       | 4/15 [00:00<00:01,  8.20it/s]
1/8:  33%|███▎      | 5/15 [00:00<00:01,  8.21it/s]
1/8:  40%|████      | 6/15 [00:00<00:01,  8.17it/s]
1/8:  47%|████▋     | 7/15 [00:00<00:00,  8.01it/s]
1/8:  53%|█████▎    | 8/15 [00:00<00:00,  8.07it/s]
1/8:  60%|██████    | 9/15 [00:01<00:00,  8.13it/s]
1/8:  67%|██████▋   | 10/15 [00:01<00:00,  8.11it/s]
1/8:  73%|███████▎  | 11/15 [00:01<00:00,  8.01it/s]
1/8:  80%|████████  | 12/15 [00:01<00:00,  8.10it/s]
1/8:  87%|████████▋ | 13/15 [00:01<00:00,  8.14it/s]
1/8:  93%|█████████▎| 14/15 [00:01<00:00,  8.18it/s]
1/8: 100%|██████████| 15/15 [00:01<00:00,  8.19it/s]
1/8: 100%|██████████| 15/15 [00:01<00:00,  8.14it/s]

2/8:   0%|          | 0/15 [00:00<?, ?it/s]
2/8:   7%|▋         | 1/15 [00:00<00:01,  8.26it/s]
2/8:  13%|█▎        | 2/15 [00:00<00:01,  8.14it/s]
2/8:  20%|██        | 3/15 [00:00<00:01,  8.15it/s]
2/8:  27%|██▋       | 4/15 [00:00<00:01,  8.19it/s]
2/8:  33%|███▎      | 5/15 [00:00<00:01,  8.17it/s]
2/8:  40%|████      | 6/15 [00:00<00:01,  8.15it/s]
2/8:  47%|████▋     | 7/15 [00:00<00:01,  7.79it/s]
2/8:  53%|█████▎    | 8/15 [00:00<00:00,  7.88it/s]
2/8:  60%|██████    | 9/15 [00:01<00:00,  7.91it/s]
2/8:  67%|██████▋   | 10/15 [00:01<00:00,  7.96it/s]
2/8:  73%|███████▎  | 11/15 [00:01<00:00,  8.01it/s]
2/8:  80%|████████  | 12/15 [00:01<00:00,  7.83it/s]
2/8:  87%|████████▋ | 13/15 [00:01<00:00,  7.24it/s]
2/8:  93%|█████████▎| 14/15 [00:01<00:00,  6.92it/s]
2/8: 100%|██████████| 15/15 [00:01<00:00,  6.73it/s]
2/8: 100%|██████████| 15/15 [00:01<00:00,  7.56it/s]

3/8:   0%|          | 0/15 [00:00<?, ?it/s]
3/8:   7%|▋         | 1/15 [00:00<00:02,  5.86it/s]
3/8:  13%|█▎        | 2/15 [00:00<00:02,  5.97it/s]
3/8:  20%|██        | 3/15 [00:00<00:02,  5.91it/s]
3/8:  27%|██▋       | 4/15 [00:00<00:02,  5.00it/s]
3/8:  33%|███▎      | 5/15 [00:00<00:01,  5.14it/s]
3/8:  40%|████      | 6/15 [00:01<00:01,  5.75it/s]
3/8:  47%|████▋     | 7/15 [00:01<00:01,  5.69it/s]
3/8:  53%|█████▎    | 8/15 [00:01<00:01,  5.66it/s]
3/8:  60%|██████    | 9/15 [00:01<00:01,  5.38it/s]
3/8:  67%|██████▋   | 10/15 [00:01<00:01,  4.85it/s]
3/8:  73%|███████▎  | 11/15 [00:02<00:00,  4.89it/s]
3/8:  80%|████████  | 12/15 [00:02<00:00,  5.30it/s]
3/8:  87%|████████▋ | 13/15 [00:02<00:00,  4.62it/s]
3/8:  93%|█████████▎| 14/15 [00:02<00:00,  4.42it/s]
3/8: 100%|██████████| 15/15 [00:02<00:00,  4.58it/s]
3/8: 100%|██████████| 15/15 [00:02<00:00,  5.05it/s]

4/8:   0%|          | 0/15 [00:00<?, ?it/s]
4/8:   7%|▋         | 1/15 [00:00<00:03,  3.90it/s]
4/8:  13%|█▎        | 2/15 [00:00<00:03,  4.16it/s]
4/8:  20%|██        | 3/15 [00:00<00:02,  4.29it/s]
4/8:  27%|██▋       | 4/15 [00:00<00:02,  4.30it/s]
4/8:  33%|███▎      | 5/15 [00:01<00:02,  4.40it/s]
4/8:  40%|████      | 6/15 [00:01<00:02,  4.39it/s]
4/8:  47%|████▋     | 7/15 [00:01<00:01,  4.25it/s]
4/8:  53%|█████▎    | 8/15 [00:01<00:01,  4.62it/s]
4/8:  60%|██████    | 9/15 [00:01<00:01,  5.33it/s]
4/8:  67%|██████▋   | 10/15 [00:02<00:00,  5.85it/s]
4/8:  73%|███████▎  | 11/15 [00:02<00:00,  6.20it/s]
4/8:  80%|████████  | 12/15 [00:02<00:00,  6.47it/s]
4/8:  87%|████████▋ | 13/15 [00:02<00:00,  6.88it/s]
4/8:  93%|█████████▎| 14/15 [00:02<00:00,  7.14it/s]
4/8: 100%|██████████| 15/15 [00:02<00:00,  7.45it/s]
4/8: 100%|██████████| 15/15 [00:02<00:00,  5.51it/s]

5/8:   0%|          | 0/15 [00:00<?, ?it/s]
5/8:   7%|▋         | 1/15 [00:00<00:01,  8.34it/s]
5/8:  13%|█▎        | 2/15 [00:00<00:01,  8.24it/s]
5/8:  20%|██        | 3/15 [00:00<00:01,  8.24it/s]
5/8:  27%|██▋       | 4/15 [00:00<00:01,  8.27it/s]
5/8:  33%|███▎      | 5/15 [00:00<00:01,  8.31it/s]
5/8:  40%|████      | 6/15 [00:00<00:01,  8.30it/s]
5/8:  47%|████▋     | 7/15 [00:00<00:00,  8.31it/s]
5/8:  53%|█████▎    | 8/15 [00:00<00:00,  8.39it/s]
5/8:  60%|██████    | 9/15 [00:01<00:00,  8.36it/s]
5/8:  67%|██████▋   | 10/15 [00:01<00:00,  8.37it/s]
5/8:  73%|███████▎  | 11/15 [00:01<00:00,  8.25it/s]
5/8:  80%|████████  | 12/15 [00:01<00:00,  8.23it/s]
5/8:  87%|████████▋ | 13/15 [00:01<00:00,  8.22it/s]
5/8:  93%|█████████▎| 14/15 [00:01<00:00,  8.21it/s]
5/8: 100%|██████████| 15/15 [00:01<00:00,  8.14it/s]
5/8: 100%|██████████| 15/15 [00:01<00:00,  8.25it/s]

6/8:   0%|          | 0/15 [00:00<?, ?it/s]
6/8:   7%|▋         | 1/15 [00:00<00:01,  7.74it/s]
6/8:  13%|█▎        | 2/15 [00:00<00:02,  6.24it/s]
6/8:  20%|██        | 3/15 [00:00<00:01,  6.83it/s]
6/8:  27%|██▋       | 4/15 [00:00<00:01,  7.35it/s]
6/8:  33%|███▎      | 5/15 [00:00<00:01,  7.69it/s]
6/8:  40%|████      | 6/15 [00:00<00:01,  7.86it/s]
6/8:  47%|████▋     | 7/15 [00:00<00:00,  8.00it/s]
6/8:  53%|█████▎    | 8/15 [00:01<00:00,  8.04it/s]
6/8:  60%|██████    | 9/15 [00:01<00:00,  8.14it/s]
6/8:  67%|██████▋   | 10/15 [00:01<00:00,  8.17it/s]
6/8:  73%|███████▎  | 11/15 [00:01<00:00,  8.21it/s]
6/8:  80%|████████  | 12/15 [00:01<00:00,  8.18it/s]
6/8:  87%|████████▋ | 13/15 [00:01<00:00,  8.22it/s]
6/8:  93%|█████████▎| 14/15 [00:01<00:00,  8.25it/s]
6/8: 100%|██████████| 15/15 [00:01<00:00,  8.27it/s]
6/8: 100%|██████████| 15/15 [00:01<00:00,  7.93it/s]

7/8:   0%|          | 0/15 [00:00<?, ?it/s]
7/8:   7%|▋         | 1/15 [00:00<00:01,  8.18it/s]
7/8:  13%|█▎        | 2/15 [00:00<00:01,  8.25it/s]
7/8:  20%|██        | 3/15 [00:00<00:01,  8.27it/s]
7/8:  27%|██▋       | 4/15 [00:00<00:01,  8.31it/s]
7/8:  33%|███▎      | 5/15 [00:00<00:01,  8.29it/s]
7/8:  40%|████      | 6/15 [00:00<00:01,  8.30it/s]
7/8:  47%|████▋     | 7/15 [00:00<00:00,  8.34it/s]
7/8:  53%|█████▎    | 8/15 [00:00<00:00,  8.26it/s]
7/8:  60%|██████    | 9/15 [00:01<00:00,  8.27it/s]
7/8:  67%|██████▋   | 10/15 [00:01<00:00,  8.28it/s]
7/8:  73%|███████▎  | 11/15 [00:01<00:00,  8.28it/s]
7/8:  80%|████████  | 12/15 [00:01<00:00,  8.26it/s]
7/8:  87%|████████▋ | 13/15 [00:01<00:00,  8.31it/s]
7/8:  93%|█████████▎| 14/15 [00:01<00:00,  8.34it/s]
7/8: 100%|██████████| 15/15 [00:01<00:00,  8.32it/s]
7/8: 100%|██████████| 15/15 [00:01<00:00,  8.29it/s]
Logging to /var/folders/7w/8xcxnwts1h7gkyvzf8c36rph0000gn/T/openai-2021-07-21-09-02-53-929161
--------------------------------------
| approxkl           | 0.00052863563 |
| clipfrac           | 0.04386459    |
| eplenmean          | 400           |
| eprewmean          | 9.33          |
| explained_variance | 0.00596       |
| fps                | 507           |
| nupdates           | 1             |
| policy_entropy     | 1.7912337     |
| policy_loss        | -0.0013858477 |
| serial_timesteps   | 400           |
| time_elapsed       | 23.6          |
| time_remaining     | 295           |
| total_timesteps    | 12000         |
| true_eprew         | 2             |
| value_loss         | 1.9345343     |
--------------------------------------
Current reward shaping 0.997
SP envs: 0/30
